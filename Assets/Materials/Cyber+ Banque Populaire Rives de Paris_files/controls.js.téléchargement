var isIE=-1!=navigator.appVersion.indexOf("MSIE"),isSafari=-1!=navigator.appVersion.indexOf("Safari");function returnEvent(t){return t||window.event}function returnEventSrcElement(t){var e=returnEvent(t);return e.target?e.target:e.srcElement}function returnEventKeyCode(t){var e=returnEvent(t);return isIE?e.keyCode:e.charCode}function cancelKeyPressed(t){var e=returnEvent(t);return e.preventDefault?e.preventDefault():e.returnValue=!1,!1}function existsSelection(t){var e=!1;if(window.getSelection){if(""==(e=""!=window.getSelection().toString()&&null!=window.getSelection().toString())){var r=getEventTarget(window,t),n=null!=r?r.tagName.toLowerCase():"";"input"!=n&&"textarea"!=n||(r.selectionStart||"0"==r.selectionStart)&&(e=r.selectionStart<r.selectionEnd)}}else document.getSelection?e=""!=document.getSelection():document.selection&&(e=""!=getPortalWindow().applicationPortalContent.applicationPanel.document.selection.createRange().text);return e}function matchRegExp(t,e,r){if(void 0!==e&&void 0!==t){var n=new RegExp(t,r);return null!=e.match(n)}return!1}function isDigit(t){return ate.common.utils.stringOperation.isDigit(t)}function onlyCharsFilter(t,e){return matchRegExp("^["+e+"]+$","number"==typeof t?String.fromCharCode(t):t,"ig")}function noCharFilter(t,e){return matchRegExp("^[^"+e+"]+$","number"==typeof t?String.fromCharCode(t):t,"ig")}function onlyNumbers(t){return matchRegExp("^[\\d]+$","number"==typeof t?String.fromCharCode(t):t,"ig")}function isInteger(t){return onlyNumbers(t)}function onlyNumbersWith(t,e){return matchRegExp("^[\\d"+e+"]+$","number"==typeof t?String.fromCharCode(t):t,"ig")}function noArrowFilter(t){return noKeyCodesFilter(t,37,40)}function noKeyCodesFilter(t,e,r){return t>=e&&t<=r}function trim(t){var e=t;return void 0!==t&&null!=t&&(e=t.replace(/(^\s*)|(\s*$)/g,"")),e}function currentPos(t,e,r){if(e.length!=t.length)return-1;for(var n=0,a=0;a<e.length;a++)"#"==e.charAt(a)&&t.charAt(a)!=r&&n++;return n}function checkMaxLength(t,e,r){e.length>=r&&cancelKeyPressed(t)}var BYPASS_KEY_CODES="\t%&'(\b.#$";function isByPassEvent(t){var e=returnEvent(t),r=e.ctrlKey||e.metaKey,n=e.keyCode;if(isSafari)switch(n){case 63232:case 63273:case 63233:case 63275:case 63234:case 63235:case 63272:case 8:case 9:case 25:return!0;default:return r}return!isIE&&(r||onlyCharsFilter(n,BYPASS_KEY_CODES))}function countChar(t,e){for(var r=0,n=null!=t?t.length:0,a=0;a<n;a++)t.charAt(a)==e&&r++;return r}function swapChar(t,e,r){if(null==t||void 0===e||null==e||""==e)return t;var n=new RegExp(e,"g");return t.replace(n,r)}function splitString(t,e){for(var r,n=new Array,a=0,i=0,o=0;o<t.length;o++)r=t.charAt(o),e.indexOf(r)>=0&&(n[i++]=t.substring(a,o),a=o+1);return n[i]=t.substring(a,t.length),n}function keepOnlyDigits(t){for(var e="",r=0;r<t.length;r++)isDigit(t.charCodeAt(r))&&(e+=t.charAt(r));return e}function trimField(t){t.value=trim(t.value)}var MONTH_PATTERN="MM",DAY_PATTERN="dd",LONG_YEAR_PATTERN="yyyy",SHORT_YEAR_PATTERN="yy";function initDateFormat(t,e){var r=t;if(void 0===r.dateFormat||null==r.dateFormat){void 0===e||void 0!==r.formatPattern&&""!=r.formatPattern||(r.formatPattern=e);for(var n={},a="",i="",o=0;o<r.formatPattern.length;o++)(i=r.formatPattern.charAt(o))==DAY_PATTERN.charAt(0)||i==MONTH_PATTERN.charAt(0)||i==SHORT_YEAR_PATTERN.charAt(0)?a+=i:n.separator=i;n.filteredDayPos=a.indexOf(DAY_PATTERN),n.filteredMonthPos=a.indexOf(MONTH_PATTERN),n.filteredYearPos=a.indexOf(LONG_YEAR_PATTERN),n.noSeparatorFormatLength=a.length,n.dayPos=r.formatPattern.indexOf(DAY_PATTERN),n.monthPos=r.formatPattern.indexOf(MONTH_PATTERN),n.yearPos=r.formatPattern.indexOf(LONG_YEAR_PATTERN),n.shortYear=!1,-1==n.yearPos&&(n.yearPos=r.formatPattern.indexOf(SHORT_YEAR_PATTERN),n.filteredYearPos=a.indexOf(SHORT_YEAR_PATTERN),n.shortYear=!0),r.dateFormat=n}}function focusDate(t,e){if(isByPassEvent(t))return!1;initDateFormat(returnEventSrcElement(t),e)}function keyPressDate(t,e){if(isByPassEvent(t))return!1;var r=returnEventKeyCode(t),n=returnEventSrcElement(t),a=n.dateFormat.separator;if(onlyNumbersWith(r,countChar(n.value,a)==countChar(n.formatPattern,a)?"":a)){if(String.fromCharCode(r)!=n.dateFormat.separator&&!existsSelection(t)){var i=n.value.length,o=n.value.indexOf(n.dateFormat.separator)>=0,u=n.dateFormat.shortYear?n.formatPattern.length+2:n.formatPattern.length,s=n.dateFormat.shortYear?n.dateFormat.noSeparatorFormatLength+2:n.dateFormat.noSeparatorFormatLength;if(o&&i>=u||!o&&i>=s)return cancelKeyPressed(t)}}else cancelKeyPressed(t)}function formatAsLongYear(t){var e=t;return 0==t.length?e="2000":1==t.length?e="200"+t:2==t.length?e="20"+t:3==t.length&&(e="2"+t),e}function formatAsShortYear(t){var e=t;return 0==t.length?e="00":1==t.length?e="0"+t:t.length>2&&(e=e.substring(2)),e}function formatDateUsingPattern(t,e){var r,n=returnEventSrcElement(t),a=e.indexOf(n.dateFormat.separator)>=0,i=e,o=n.formatPattern,u=i.length,s=n.dateFormat.separator,l=new Date,c=n.dateFormat.noSeparatorFormatLength;if(-1!=n.dateFormat.yearPos&&(c=n.dateFormat.noSeparatorFormatLength-2),!a&&u<c&&u>0)return e;if(a){var g=countChar(o,s),m=countChar(e,s),f=o.indexOf(s),E=e.indexOf(s);if(g!=m||E>f)return e}if(-1!=n.dateFormat.dayPos){var v="";if((r=a?n.dateFormat.dayPos:n.dateFormat.filteredDayPos)>=u||i.charAt(r)==s?v=1==(v=l.getDate()+"").length?"0"+v:v:r+1>=u||i.charAt(r+1)==n.dateFormat.separator?(v="0"+i.charAt(r),u=(i=i.substring(0,r)+"0"+i.substring(r,u)).length):v=i.substring(r,r+2),!(isInteger(v)&&v<32))return e;o=swapChar(o,DAY_PATTERN,v)}if(-1!=n.dateFormat.monthPos){var d="";if((r=a?n.dateFormat.monthPos:n.dateFormat.filteredMonthPos)>=u||i.charAt(r)==s?d=1==(d=l.getMonth()+1+"").length?"0"+d:d:r+1>=u||i.charAt(r+1)==s?(d="0"+i.charAt(r),u=(i=i.substring(0,r)+"0"+i.substring(r,u)).length):d=i.substring(r,r+2),!(isInteger(d)&&d<13))return e;o=swapChar(o,MONTH_PATTERN,d)}if(-1!=n.dateFormat.yearPos){var h="";if((r=a?n.dateFormat.yearPos:n.dateFormat.filteredYearPos)>=u||i.charAt(r)==s)h=(l.getYear()<1e3?l.getYear()+1900:l.getYear())+"";else for(var A=r,P=0;A<u&&i.charAt(A)!=s&&P<4;A++,P++)h+=i.charAt(A);var T=h;if(T=n.dateFormat.shortYear?formatAsShortYear(h):formatAsLongYear(h),!isInteger(h))return e;o=swapChar(o,n.dateFormat.shortYear?SHORT_YEAR_PATTERN:LONG_YEAR_PATTERN,T)}return o}function blurDate(t,e){if(isByPassEvent(t))return!1;var r=returnEventSrcElement(t);""!=r.value&&(r.value=formatDateUsingPattern(t,r.value))}var DECIMAL_PATTERN_DIGIT="#",DECIMAL_PATTERN_ZERO="0",DEFAULT_DECIMAL_SEP=".";function formatDecimal(t,e,r){if(void 0===t||null==t||""==new String(trim(t)))return null;var n,a=t.toString(),i=e.getMsgUtil().getMessage("DECIMAL_SEP"),o=i+DEFAULT_DECIMAL_SEP,u=e.getMsgUtil().getMessage("DIGIT_GROUP_SEP"),s=e.getMsgUtil().getMessage("MINUS_SIGN"),l=a.indexOf(s)>=0,c=splitString(a,o),g=splitString(r,o),m="",f="";if(0==c.length)return"";if(2==g.length){for(var E=g[1],v=2==c.length?keepOnlyDigits(c[1]):"",d=0;d<E.length;d++)(n=E.charAt(d))==s&&l?m=s+m:d<v.length&&isDigit(v.charCodeAt(d))?f+=v.charAt(d):n==DECIMAL_PATTERN_ZERO&&(f+=DECIMAL_PATTERN_ZERO);f.length>0&&(f=i+f)}for(var h=g[0],A=keepOnlyDigits(c[0]),P=h.length-1,T=A.length-1;P>=0;P--)(n=h.charAt(P))==u&&T>=0?m=u+m:n==s&&l?m=s+m:T>=0&&isDigit(A.charCodeAt(T))?(m=A.charAt(T)+m,T--):n==DECIMAL_PATTERN_ZERO&&(m=DECIMAL_PATTERN_ZERO+m);return m+f}function initDecimalFormat(t,e){var r=e.getMsgUtil().getMessage("DECIMAL_SEP"),n=e.getMsgUtil().getMessage("DIGIT_GROUP_SEP"),a=e.getMsgUtil().getMessage("MINUS_SIGN");t.decimalSepIndex=-1,t.hasDigitGroupSep=!1,t.hasMinusSignSep=!1,t.setAttribute("nbDecimals",0);for(var i,o=0,u=t.formatPattern.length-1;u>=0;u--)(i=t.formatPattern.charAt(u))==r?(t.decimalSepIndex=u,t.setAttribute("nbDecimals",o)):i==DECIMAL_PATTERN_DIGIT||i==DECIMAL_PATTERN_ZERO?o++:i==n?t.hasDigitGroupSep=!0:i==a&&(t.hasMinusSign=!0);t.setAttribute("nbDigits",o)}function focusDecimal(t,e,r){if(isByPassEvent(t))return!1;var n=returnEventSrcElement(t);void 0!==r&&(n.formatPattern=r),initDecimalFormat(n,e)}function keyPressDecimal(t,e,r){if(isByPassEvent(t))return!1;var n=e.getMsgUtil().getMessage("DECIMAL_SEP"),a=e.getMsgUtil().getMessage("DIGIT_GROUP_SEP"),i=e.getMsgUtil().getMessage("MINUS_SIGN"),o=returnEventSrcElement(t),u=returnEventKeyCode(t),s="";(o.hasMinusSign&&-1==o.value.indexOf(i)&&(s+=i),-1!=o.decimalSepIndex&&-1==o.value.indexOf(n)&&-1==o.value.indexOf(DEFAULT_DECIMAL_SEP)&&(s+=n,s+=DEFAULT_DECIMAL_SEP),o.hasDigitGroupSep&&(s+=a,160==a.charCodeAt(0)&&(s+=" ")),onlyNumbersWith(u,s))?ate.common.utils.inputControl.getMaxDigitsRemaining(APW().document,o)<=0&&s.indexOf(String.fromCharCode(u))<0&&cancelKeyPressed(t):cancelKeyPressed(t);"0"==o.getAttribute("nbDecimals")&&(o.valueBefore=o.value,o.lockInt=!1)}function onChangeDecimal(t,e){if(isByPassEvent(t))return!1;var r=returnEventSrcElement(t);if(r.value=trim(r.value),"0"!=r.getAttribute("nbDecimals"))return!1;if(r.value!=r.valueBefore&&r.valueBefore&&r.valueBefore.length<=r.value.length&&0==r.lockInt){r.lockInt=!0;for(var n="",a=0;a<r.value.length;a++)isDigit(r.value.charCodeAt(a))&&(n+=r.value.charAt(a));var i=parseInt(r.getAttribute("nbDigits"));i>0&&n.length>i&&(r.value=r.valueBefore)}}function blurDecimal(t,e,r){if(isByPassEvent(t))return!1;var n=returnEventSrcElement(t);""!=n.value&&(n.value=formatDecimal(n.value,e,n.formatPattern))}function pasteDecimal(t,e){if(isByPassEvent(t))return!1;var r=ate.common.utils.stringOperation,n=ate.common.utils.inputControl,a=returnEvent(t),i=a.clipboardData?a.clipboardData:window.clipboardData,o=r.purgeString(i?i.getData("Text"):""," "),u=r.clean(o,",-."),s=returnEventSrcElement(t),l=n.getMaxDigitsRemaining(APW().document,s);isInteger(u)&&l>0&&n.replaceSelectedText(APW().document,s,o.substr(0,l)),cancelKeyPressed(t)}function adac(t,e,r){attachDateControls(t,e,r)}function attachDateControls(t,e,r){var n=t.document.getElementById(e);attEvt(t,n,"focus","TW().focusDate(arguments[0], '"+r+"');",!1),attEvt(t,n,"blur","TW().blurDate(arguments[0], '"+r+"');",!1),attEvt(t,n,"keypress","TW().keyPressDate(arguments[0], '"+r+"');",!1)}function adec(t,e,r){attachDecimalControls(t,e,r)}function attachDecimalControls(t,e,r){var n=t.document.getElementById(e);attEvt(t,n,"focus","TW().focusDecimal(arguments[0], window, '"+r+"');",!1),attEvt(t,n,"blur","TW().blurDecimal(arguments[0], window, '"+r+"');",!1),attEvt(t,n,"keypress","TW().keyPressDecimal(arguments[0], window, '"+r+"');",!1),attEvt(t,n,"change","TW().onChangeDecimal(arguments[0], '"+r+"');",!1),attEvt(t,n,"paste","TW().pasteDecimal(arguments[0], '"+r+"');",!1)}function textCounter(t,e){var r=returnEventSrcElement(t);if(null!=r&&r.value.length>e)return r.value=r.value.substring(0,e),!1}function atc(t,e,r){var n=t.document.getElementById(e);attEvt(t,n,"blur","TW().trimField(TW().returnEventSrcElement(arguments[0]));",!1),attEvt(t,n,"keydown","TW().textCounter(arguments[0], '"+r+"');",!1),attEvt(t,n,"paste","TW().textCounter(arguments[0], '"+r+"');",!1),attEvt(t,n,"keyup","TW().textCounter(arguments[0], '"+r+"');",!1)}function atfc(t,e,r){var n=t.document.getElementById(e);attEvt(t,n,"blur","TW().trimField(TW().returnEventSrcElement(arguments[0]));",!1);var a=n.getAttribute("formatPattern");a&&(n.maxLength=a.length,attEvt(t,n,"focus","TW().focusDecimal(arguments[0], window, '"+a+"');",!1),attEvt(t,n,"keypress","TW().keyPressDecimal(arguments[0], window, '"+a+"');",!1),attEvt(t,n,"change","TW().onChangeDecimal(arguments[0], '"+a+"');",!1),attEvt(t,n,"blur","TW().blurNumericWithoutFormatting(arguments[0]);",!1)),r&&attEvt(t,n,"keyup","TW().autoTab(window, arguments[0]);",!1)}function blurNumericWithoutFormatting(t){if(isByPassEvent(t))return!1;var e=returnEventSrcElement(t);onlyNumbers(e.value)||(e.value="")}function autoTab(t,e){ate.common.utils.inputControl.autoTab(returnEventSrcElement(e),e,t.document)}function isMonth(t){var e=!1;return t&&t.length>0&&!isNaN(t)&&parseInt(parseFloat(t))>0&&parseInt(parseFloat(t))<13&&(e=!0),e}function isGoodYear(t,e,r){var n=!1;return!isNaN(t)&&parseInt(t)>=e&&parseInt(t)<=r&&(n=!0),n}function getDateSeparator(t){for(var e=t?t.length:0,r=null,n=0;n<e;n++){var a=t.charAt(n);if(a!=DAY_PATTERN.charAt(0)&&a!=MONTH_PATTERN.charAt(0)&&a!=SHORT_YEAR_PATTERN.charAt(0)){r=a;break}}return r}
//# sourceMappingURL=controls.js.map
